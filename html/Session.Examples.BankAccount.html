<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Session.Examples.BankAccount</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="Content-Style-Type" content="text/css"/>
<link href="Agda.css" rel="stylesheet" type="text/css"/></head><body><p><a href="https://www.gnu.org/licenses/gpl.html">2013-2014 matteo.acerbi@gmail.com</a></p>
<h2 id="bank-account">Bank account</h2>
<p>Example from Brady and Hammond's &quot;Correct-by-Construction Concurrency&quot;.</p>
<p>Reference (unsafe) code:</p>
<pre><code>moveMoney(sum, sender, receiver) {
  lock(sender);
  lock(receiver);
  sendFunds = read(sender);
  recvFunds = read(receiver);
  if (sendFunds &lt; sum) {
    putStrLn(&quot;Insufficient funds&quot;);
    return;
  }
  write(sender, sendFunds - sum);
  write(receiver, recvFunds + sum);
  unlock(receiver);
  unlock(sender);
}</code></pre>
<p>Instead of defining safe locking protocols as in the paper, we simply model the memory locations as processes.</p>
<pre></a
  ><a name="689" class="Keyword"
  >module</a
  ><a name="695"
  > </a
  ><a name="696" href="Session.Examples.BankAccount.html#1" class="Module"
  >Session.Examples.BankAccount</a
  ><a name="724"
  > </a
  ><a name="725" class="Keyword"
  >where</a
  ><a name="730"
  >

</a
  ><a name="732" class="Keyword"
  >open</a
  ><a name="736"
  > </a
  ><a name="737" class="Keyword"
  >import</a
  ><a name="743"
  > </a
  ><a name="744" href="Base.html#1" class="Module"
  >Base</a
  ><a name="748"
  >
</a
  ><a name="749" class="Keyword"
  >open</a
  ><a name="753"
  > </a
  ><a name="754" class="Keyword"
  >import</a
  ><a name="760"
  > </a
  ><a name="761" href="Session.html#1" class="Module"
  >Session</a
  ><a name="768"
  >
</a
  ><a name="769" class="Keyword"
  >open</a
  ><a name="773"
  > </a
  ><a name="774" class="Keyword"
  >import</a
  ><a name="780"
  > </a
  ><a name="781" href="Data.Nat.html#1" class="Module"
  >Data.Nat</a
  ><a name="789"
  > </a
  ><a name="790" class="Symbol"
  >as</a
  ><a name="792"
  > </a
  ><a name="793" class="Module"
  >&#8469;</a
  ><a name="794"
  >
</a
  ><a name="795" class="Keyword"
  >open</a
  ><a name="799"
  > </a
  ><a name="800" class="Keyword"
  >import</a
  ><a name="806"
  > </a
  ><a name="807" href="IO.Primitive.html#1" class="Module"
  >IO.Primitive</a
  ><a name="819"
  ></pre>

<pre></a
  ><a name="845" href="Session.Examples.BankAccount.html#845" class="Function"
  >moveMoney</a
  ><a name="854"
  > </a
  ><a name="855" class="Symbol"
  >:</a
  ><a name="856"
  > </a
  ><a name="857" class="Symbol"
  >(</a
  ><a name="858" href="Session.Examples.BankAccount.html#858" class="Bound"
  >sum</a
  ><a name="861"
  > </a
  ><a name="862" class="Symbol"
  >:</a
  ><a name="863"
  > </a
  ><a name="864" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="865" class="Symbol"
  >)</a
  ><a name="866"
  > </a
  ><a name="867" class="Symbol"
  >&#8594;</a
  ><a name="868"
  >
            </a
  ><a name="881" href="Data.List.html#696" class="InductiveConstructor"
  >[]</a
  ><a name="883"
  > </a
  ><a name="884" href="Data.List.html#711" class="InductiveConstructor Operator"
  >&#8759;</a
  ><a name="885"
  > </a
  ><a name="886" class="Symbol"
  >(</a
  ><a name="887" href="Data.Product.html#509" class="InductiveConstructor Operator"
  >&#187;&#187;</a
  ><a name="889"
  > </a
  ><a name="890" class="Symbol"
  >(</a
  ><a name="891" href="Session.html#199" class="Function"
  >De</a
  ><a name="893"
  > </a
  ><a name="894" href="Base.html#136" class="Record"
  >&#8868;</a
  ><a name="895"
  > </a
  ><a name="896" href="Function.html#2475" class="Function Operator"
  >&#8715;</a
  ><a name="897"
  > </a
  ><a name="898" href="Session.html#825" class="Function"
  >`&#928;^</a
  ><a name="901"
  > </a
  ><a name="902" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="903"
  > </a
  ><a name="904" class="Symbol"
  >&#955;</a
  ><a name="905"
  > </a
  ><a name="906" href="Session.Examples.BankAccount.html#906" class="Bound"
  >_</a
  ><a name="907"
  > </a
  ><a name="908" class="Symbol"
  >&#8594;</a
  ><a name="909"
  > </a
  ><a name="910" href="Session.html#821" class="Function"
  >`&#931;^</a
  ><a name="913"
  > </a
  ><a name="914" class="Symbol"
  >(</a
  ><a name="915" href="Data.Maybe.Core.html#315" class="Datatype"
  >1+</a
  ><a name="917"
  > </a
  ><a name="918" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="919" class="Symbol"
  >)</a
  ><a name="920"
  > </a
  ><a name="921" class="Symbol"
  >&#955;</a
  ><a name="922"
  > </a
  ><a name="923" href="Session.Examples.BankAccount.html#923" class="Bound"
  >_</a
  ><a name="924"
  > </a
  ><a name="925" class="Symbol"
  >&#8594;</a
  ><a name="926"
  > </a
  ><a name="927" href="Session.html#321" class="InductiveConstructor"
  >`I</a
  ><a name="929"
  > </a
  ><a name="930" href="Base.html#168" class="InductiveConstructor"
  >tt</a
  ><a name="932" class="Symbol"
  >))</a
  ><a name="934"
  >
               </a
  ><a name="950" href="Data.List.html#711" class="InductiveConstructor Operator"
  >&#8759;</a
  ><a name="951"
  > </a
  ><a name="952" class="Symbol"
  >(</a
  ><a name="953" href="Data.Product.html#509" class="InductiveConstructor Operator"
  >&#187;&#187;</a
  ><a name="955"
  > </a
  ><a name="956" class="Symbol"
  >(</a
  ><a name="957" href="Session.html#199" class="Function"
  >De</a
  ><a name="959"
  > </a
  ><a name="960" href="Base.html#136" class="Record"
  >&#8868;</a
  ><a name="961"
  > </a
  ><a name="962" href="Function.html#2475" class="Function Operator"
  >&#8715;</a
  ><a name="963"
  > </a
  ><a name="964" href="Session.html#825" class="Function"
  >`&#928;^</a
  ><a name="967"
  > </a
  ><a name="968" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="969"
  > </a
  ><a name="970" class="Symbol"
  >&#955;</a
  ><a name="971"
  > </a
  ><a name="972" href="Session.Examples.BankAccount.html#972" class="Bound"
  >_</a
  ><a name="973"
  > </a
  ><a name="974" class="Symbol"
  >&#8594;</a
  ><a name="975"
  > </a
  ><a name="976" href="Session.html#821" class="Function"
  >`&#931;^</a
  ><a name="979"
  > </a
  ><a name="980" class="Symbol"
  >(</a
  ><a name="981" href="Data.Maybe.Core.html#315" class="Datatype"
  >1+</a
  ><a name="983"
  > </a
  ><a name="984" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="985" class="Symbol"
  >)</a
  ><a name="986"
  > </a
  ><a name="987" class="Symbol"
  >&#955;</a
  ><a name="988"
  > </a
  ><a name="989" href="Session.Examples.BankAccount.html#989" class="Bound"
  >_</a
  ><a name="990"
  > </a
  ><a name="991" class="Symbol"
  >&#8594;</a
  ><a name="992"
  > </a
  ><a name="993" href="Session.html#321" class="InductiveConstructor"
  >`I</a
  ><a name="995"
  > </a
  ><a name="996" href="Base.html#168" class="InductiveConstructor"
  >tt</a
  ><a name="998" class="Symbol"
  >))</a
  ><a name="1000"
  >
            </a
  ><a name="1013" href="Session.html#12647" class="Function Operator"
  >[IO</a
  ><a name="1016"
  > </a
  ><a name="1017" href="Base.html#136" class="Record"
  >&#8868;</a
  ><a name="1018"
  > </a
  ><a name="1019" href="Session.html#12647" class="Function Operator"
  >]&gt;</a
  ><a name="1021"
  >
            </a
  ><a name="1034" href="Data.List.html#696" class="InductiveConstructor"
  >[]</a
  ><a name="1036"
  >
</a
  ><a name="1037" href="Session.Examples.BankAccount.html#845" class="Function"
  >moveMoney</a
  ><a name="1046"
  > </a
  ><a name="1047" href="Session.Examples.BankAccount.html#1047" class="Bound"
  >sum</a
  ><a name="1050"
  > </a
  ><a name="1051" class="Symbol"
  >=</a
  ><a name="1052"
  > </a
  ><a name="1053" href="Session.html#11699" class="Function"
  >get</a
  ><a name="1056"
  > </a
  ><a name="1057" class="Symbol"
  >(</a
  ><a name="1058" href="Data.List.Any.html#1222" class="InductiveConstructor Operator"
  >S&gt;</a
  ><a name="1060"
  > </a
  ><a name="1061" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1063" class="Symbol"
  >)</a
  ><a name="1064"
  > </a
  ><a name="1065" class="Symbol"
  >&#955;</a
  ><a name="1066"
  > </a
  ><a name="1067" href="Session.Examples.BankAccount.html#1067" class="Bound"
  >sendFunds</a
  ><a name="1076"
  > </a
  ><a name="1077" class="Symbol"
  >&#8594;</a
  ><a name="1078"
  > 
                </a
  ><a name="1096" href="Session.html#11699" class="Function"
  >get</a
  ><a name="1099"
  > </a
  ><a name="1100" class="Symbol"
  >(</a
  ><a name="1101"
  >   </a
  ><a name="1104" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1106" class="Symbol"
  >)</a
  ><a name="1107"
  > </a
  ><a name="1108" class="Symbol"
  >&#955;</a
  ><a name="1109"
  > </a
  ><a name="1110" href="Session.Examples.BankAccount.html#1110" class="Bound"
  >recvFunds</a
  ><a name="1119"
  > </a
  ><a name="1120" class="Symbol"
  >&#8594;</a
  ><a name="1121"
  > 
                </a
  ><a name="1139" href="Session.Examples.BankAccount.html#1357" class="Function"
  >respond</a
  ><a name="1146"
  > </a
  ><a name="1147" href="Session.Examples.BankAccount.html#1047" class="Bound"
  >sum</a
  ><a name="1150"
  > </a
  ><a name="1151" href="Session.Examples.BankAccount.html#1067" class="Bound"
  >sendFunds</a
  ><a name="1160"
  > </a
  ><a name="1161" href="Session.Examples.BankAccount.html#1110" class="Bound"
  >recvFunds</a
  ><a name="1170"
  > </a
  ><a name="1171" class="Keyword"
  >where</a
  ><a name="1176"
  >
  </a
  ><a name="1179" href="Session.Examples.BankAccount.html#1179" class="Function"
  >success</a
  ><a name="1186"
  > </a
  ><a name="1187" class="Symbol"
  >:</a
  ><a name="1188"
  > </a
  ><a name="1189" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1190"
  > </a
  ><a name="1191" class="Symbol"
  >&#8594;</a
  ><a name="1192"
  > </a
  ><a name="1193" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1194"
  > </a
  ><a name="1195" class="Symbol"
  >&#8594;</a
  ><a name="1196"
  > </a
  ><a name="1197" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1198"
  > </a
  ><a name="1199" class="Symbol"
  >&#8594;</a
  ><a name="1200"
  > </a
  ><a name="1201" class="Symbol"
  >_</a
  ><a name="1202"
  >
  </a
  ><a name="1205" href="Session.Examples.BankAccount.html#1179" class="Function"
  >success</a
  ><a name="1212"
  > </a
  ><a name="1213" href="Session.Examples.BankAccount.html#1213" class="Bound"
  >sum</a
  ><a name="1216"
  > </a
  ><a name="1217" href="Session.Examples.BankAccount.html#1217" class="Bound"
  >sendFunds</a
  ><a name="1226"
  > </a
  ><a name="1227" href="Session.Examples.BankAccount.html#1227" class="Bound"
  >recvFunds</a
  ><a name="1236"
  > </a
  ><a name="1237" class="Symbol"
  >=</a
  ><a name="1238"
  > </a
  ><a name="1239" href="Session.html#11490" class="Function"
  >put</a
  ><a name="1242"
  > </a
  ><a name="1243" class="Symbol"
  >(</a
  ><a name="1244" href="Data.List.Any.html#1222" class="InductiveConstructor Operator"
  >S&gt;</a
  ><a name="1246"
  > </a
  ><a name="1247" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1249" class="Symbol"
  >)</a
  ><a name="1250"
  > </a
  ><a name="1251" class="Symbol"
  >(</a
  ><a name="1252" href="Data.Maybe.Core.html#353" class="InductiveConstructor"
  >&gt;</a
  ><a name="1253"
  > </a
  ><a name="1254" href="Session.Examples.BankAccount.html#1217" class="Bound"
  >sendFunds</a
  ><a name="1263" class="Symbol"
  >)</a
  ><a name="1264"
  > </a
  ><a name="1265" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="1266"
  > </a
  ><a name="1267" href="Session.html#9609" class="InductiveConstructor Operator"
  >end</a
  ><a name="1270"
  > </a
  ><a name="1271" class="Symbol"
  >(</a
  ><a name="1272" href="Data.List.Any.html#1222" class="InductiveConstructor Operator"
  >S&gt;</a
  ><a name="1274"
  > </a
  ><a name="1275" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1277" class="Symbol"
  >)</a
  ><a name="1278"
  >
                                  </a
  ><a name="1313" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="1314"
  > </a
  ><a name="1315" href="Session.html#11490" class="Function"
  >put</a
  ><a name="1318"
  >     </a
  ><a name="1323" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1325"
  >  </a
  ><a name="1327" class="Symbol"
  >(</a
  ><a name="1328" href="Data.Maybe.Core.html#353" class="InductiveConstructor"
  >&gt;</a
  ><a name="1329"
  > </a
  ><a name="1330" href="Session.Examples.BankAccount.html#1227" class="Bound"
  >recvFunds</a
  ><a name="1339" class="Symbol"
  >)</a
  ><a name="1340"
  > </a
  ><a name="1341" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="1342"
  > </a
  ><a name="1343" href="Session.html#9609" class="InductiveConstructor Operator"
  >end</a
  ><a name="1346"
  >     </a
  ><a name="1351" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1353"
  > 
  </a
  ><a name="1357" href="Session.Examples.BankAccount.html#1357" class="Function"
  >respond</a
  ><a name="1364"
  > </a
  ><a name="1365" class="Symbol"
  >:</a
  ><a name="1366"
  > </a
  ><a name="1367" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1368"
  > </a
  ><a name="1369" class="Symbol"
  >&#8594;</a
  ><a name="1370"
  > </a
  ><a name="1371" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1372"
  > </a
  ><a name="1373" class="Symbol"
  >&#8594;</a
  ><a name="1374"
  > </a
  ><a name="1375" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1376"
  > </a
  ><a name="1377" class="Symbol"
  >&#8594;</a
  ><a name="1378"
  > </a
  ><a name="1379" class="Symbol"
  >_</a
  ><a name="1380"
  >
  </a
  ><a name="1383" href="Session.Examples.BankAccount.html#1357" class="Function"
  >respond</a
  ><a name="1390"
  > </a
  ><a name="1391" href="Session.Examples.BankAccount.html#1391" class="Bound"
  >sum</a
  ><a name="1394"
  >  </a
  ><a name="1396" href="Session.Examples.BankAccount.html#1396" class="Bound"
  >sendFunds</a
  ><a name="1405"
  > </a
  ><a name="1406" href="Session.Examples.BankAccount.html#1406" class="Bound"
  >recvFunds</a
  ><a name="1415"
  > </a
  ><a name="1416" class="Keyword"
  >with</a
  ><a name="1420"
  > </a
  ><a name="1421" href="Data.Nat.html#3791" class="Function"
  >compare</a
  ><a name="1428"
  > </a
  ><a name="1429" href="Session.Examples.BankAccount.html#1396" class="Bound"
  >sendFunds</a
  ><a name="1438"
  > </a
  ><a name="1439" href="Session.Examples.BankAccount.html#1391" class="Bound"
  >sum</a
  ><a name="1442"
  > </a
  ><a name="1443" class="Comment"
  >-- TODO &#8804;?</a
  ><a name="1453"
  >
  </a
  ><a name="1456" href="Session.Examples.BankAccount.html#1357" class="Function"
  >respond</a
  ><a name="1463"
  > </a
  ><a name="1464" class="DottedPattern Symbol"
  >._</a
  ><a name="1466"
  >   </a
  ><a name="1469" href="Session.Examples.BankAccount.html#1469" class="Bound"
  >sendFunds</a
  ><a name="1478"
  > </a
  ><a name="1479" href="Session.Examples.BankAccount.html#1479" class="Bound"
  >recvFunds</a
  ><a name="1488"
  > </a
  ><a name="1489" class="Symbol"
  >|</a
  ><a name="1490"
  > </a
  ><a name="1491" href="Data.Nat.html#3669" class="InductiveConstructor"
  >less</a
  ><a name="1495"
  >    </a
  ><a name="1499" class="DottedPattern Symbol"
  >._</a
  ><a name="1501"
  > </a
  ><a name="1502" href="Session.Examples.BankAccount.html#1502" class="Bound"
  >k</a
  ><a name="1503"
  > </a
  ><a name="1504" class="Symbol"
  >=</a
  ><a name="1505"
  > </a
  ><a name="1506" href="Session.html#9533" class="InductiveConstructor Operator"
  >&#8657;</a
  ><a name="1507"
  > </a
  ><a name="1508" href="IO.Primitive.html#1501" class="Postulate"
  >putStrLn</a
  ><a name="1516"
  > </a
  ><a name="1517" href="Base.html#4675" class="Function Operator"
  >&#171;</a
  ><a name="1518"
  > </a
  ><a name="1519" class="String"
  >&quot;Insufficient funds&quot;</a
  ><a name="1539"
  > </a
  ><a name="1540" href="Base.html#4675" class="Function Operator"
  >&#187;</a
  ><a name="1541"
  >
                                                  </a
  ><a name="1592" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="1593"
  > </a
  ><a name="1594" href="Session.html#11490" class="Function"
  >put</a
  ><a name="1597"
  >  </a
  ><a name="1599" class="Symbol"
  >(</a
  ><a name="1600" href="Data.List.Any.html#1222" class="InductiveConstructor Operator"
  >S&gt;</a
  ><a name="1602"
  > </a
  ><a name="1603" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1605" class="Symbol"
  >)</a
  ><a name="1606"
  > </a
  ><a name="1607" href="Data.Maybe.Core.html#383" class="InductiveConstructor"
  >&#949;</a
  ><a name="1608"
  > </a
  ><a name="1609" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="1610"
  > </a
  ><a name="1611" href="Session.html#9609" class="InductiveConstructor Operator"
  >end</a
  ><a name="1614"
  > </a
  ><a name="1615" class="Symbol"
  >(</a
  ><a name="1616" href="Data.List.Any.html#1222" class="InductiveConstructor Operator"
  >S&gt;</a
  ><a name="1618"
  > </a
  ><a name="1619" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1621" class="Symbol"
  >)</a
  ><a name="1622"
  >
                                                  </a
  ><a name="1673" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="1674"
  > </a
  ><a name="1675" href="Session.html#11490" class="Function"
  >put</a
  ><a name="1678"
  >      </a
  ><a name="1684" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1686"
  >  </a
  ><a name="1688" href="Data.Maybe.Core.html#383" class="InductiveConstructor"
  >&#949;</a
  ><a name="1689"
  > </a
  ><a name="1690" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="1691"
  > </a
  ><a name="1692" href="Session.html#9609" class="InductiveConstructor Operator"
  >end</a
  ><a name="1695"
  >     </a
  ><a name="1700" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="1702"
  > 
  </a
  ><a name="1706" href="Session.Examples.BankAccount.html#1357" class="Function"
  >respond</a
  ><a name="1713"
  > </a
  ><a name="1714" href="Session.Examples.BankAccount.html#1714" class="Bound"
  >sum</a
  ><a name="1717"
  >  </a
  ><a name="1719" class="DottedPattern Symbol"
  >._</a
  ><a name="1721"
  >        </a
  ><a name="1729" href="Session.Examples.BankAccount.html#1729" class="Bound"
  >recvFunds</a
  ><a name="1738"
  > </a
  ><a name="1739" class="Symbol"
  >|</a
  ><a name="1740"
  > </a
  ><a name="1741" href="Data.Nat.html#3714" class="InductiveConstructor"
  >equal</a
  ><a name="1746"
  >   </a
  ><a name="1749" class="DottedPattern Symbol"
  >._</a
  ><a name="1751"
  >   </a
  ><a name="1754" class="Symbol"
  >=</a
  ><a name="1755"
  > </a
  ><a name="1756" href="Session.Examples.BankAccount.html#1179" class="Function"
  >success</a
  ><a name="1763"
  > </a
  ><a name="1764" href="Session.Examples.BankAccount.html#1714" class="Bound"
  >sum</a
  ><a name="1767"
  >      </a
  ><a name="1773" class="Number"
  >0</a
  ><a name="1774"
  >  </a
  ><a name="1776" class="Symbol"
  >(</a
  ><a name="1777" href="Session.Examples.BankAccount.html#1714" class="Bound"
  >sum</a
  ><a name="1780"
  > </a
  ><a name="1781" href="Data.Nat.html#2178" class="Primitive Operator"
  >&#8469;.+</a
  ><a name="1784"
  > </a
  ><a name="1785" href="Session.Examples.BankAccount.html#1729" class="Bound"
  >recvFunds</a
  ><a name="1794" class="Symbol"
  >)</a
  ><a name="1795"
  >
  </a
  ><a name="1798" href="Session.Examples.BankAccount.html#1357" class="Function"
  >respond</a
  ><a name="1805"
  > </a
  ><a name="1806" href="Session.Examples.BankAccount.html#1806" class="Bound"
  >sum</a
  ><a name="1809"
  >  </a
  ><a name="1811" class="DottedPattern Symbol"
  >._</a
  ><a name="1813"
  >        </a
  ><a name="1821" href="Session.Examples.BankAccount.html#1821" class="Bound"
  >recvFunds</a
  ><a name="1830"
  > </a
  ><a name="1831" class="Symbol"
  >|</a
  ><a name="1832"
  > </a
  ><a name="1833" href="Data.Nat.html#3747" class="InductiveConstructor"
  >greater</a
  ><a name="1840"
  > </a
  ><a name="1841" class="DottedPattern Symbol"
  >._</a
  ><a name="1843"
  > </a
  ><a name="1844" href="Session.Examples.BankAccount.html#1844" class="Bound"
  >k</a
  ><a name="1845"
  > </a
  ><a name="1846" class="Symbol"
  >=</a
  ><a name="1847"
  > </a
  ><a name="1848" href="Session.Examples.BankAccount.html#1179" class="Function"
  >success</a
  ><a name="1855"
  > </a
  ><a name="1856" href="Session.Examples.BankAccount.html#1806" class="Bound"
  >sum</a
  ><a name="1859"
  > </a
  ><a name="1860" class="Symbol"
  >(</a
  ><a name="1861" href="Data.Nat.html#725" class="InductiveConstructor"
  >suc</a
  ><a name="1864"
  > </a
  ><a name="1865" href="Session.Examples.BankAccount.html#1844" class="Bound"
  >k</a
  ><a name="1866" class="Symbol"
  >)</a
  ><a name="1867"
  > </a
  ><a name="1868" class="Symbol"
  >(</a
  ><a name="1869" href="Session.Examples.BankAccount.html#1806" class="Bound"
  >sum</a
  ><a name="1872"
  > </a
  ><a name="1873" href="Data.Nat.html#2178" class="Primitive Operator"
  >&#8469;.+</a
  ><a name="1876"
  > </a
  ><a name="1877" href="Session.Examples.BankAccount.html#1821" class="Bound"
  >recvFunds</a
  ><a name="1886" class="Symbol"
  >)</a
  ><a name="1887"
  ></pre>

<pre></a
  ><a name="1913" href="Session.Examples.BankAccount.html#1913" class="Function"
  >fund</a
  ><a name="1917"
  > </a
  ><a name="1918" class="Symbol"
  >:</a
  ><a name="1919"
  > </a
  ><a name="1920" class="Symbol"
  >(</a
  ><a name="1921" href="Session.Examples.BankAccount.html#1921" class="Bound"
  >init</a
  ><a name="1925"
  > </a
  ><a name="1926" class="Symbol"
  >:</a
  ><a name="1927"
  > </a
  ><a name="1928" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1929" class="Symbol"
  >)</a
  ><a name="1930"
  > </a
  ><a name="1931" class="Symbol"
  >&#8594;</a
  ><a name="1932"
  > </a
  ><a name="1933" href="Data.List.html#696" class="InductiveConstructor"
  >[]</a
  ><a name="1935"
  > </a
  ><a name="1936" href="Data.List.html#711" class="InductiveConstructor Operator"
  >&#8759;</a
  ><a name="1937"
  > </a
  ><a name="1938" class="Symbol"
  >((</a
  ><a name="1940" href="Session.html#199" class="Function"
  >De</a
  ><a name="1942"
  > </a
  ><a name="1943" href="Base.html#136" class="Record"
  >&#8868;</a
  ><a name="1944"
  > </a
  ><a name="1945" href="Function.html#2475" class="Function Operator"
  >&#8715;</a
  ><a name="1946"
  > </a
  ><a name="1947" href="Session.html#825" class="Function"
  >`&#928;^</a
  ><a name="1950"
  > </a
  ><a name="1951" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1952"
  >  </a
  ><a name="1954" class="Symbol"
  >&#955;</a
  ><a name="1955"
  > </a
  ><a name="1956" href="Session.Examples.BankAccount.html#1956" class="Bound"
  >_</a
  ><a name="1957"
  > </a
  ><a name="1958" class="Symbol"
  >&#8594;</a
  ><a name="1959"
  > </a
  ><a name="1960" href="Session.html#821" class="Function"
  >`&#931;^</a
  ><a name="1963"
  > </a
  ><a name="1964" class="Symbol"
  >(</a
  ><a name="1965" href="Data.Maybe.Core.html#315" class="Datatype"
  >1+</a
  ><a name="1967"
  > </a
  ><a name="1968" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="1969" class="Symbol"
  >)</a
  ><a name="1970"
  > </a
  ><a name="1971" class="Symbol"
  >&#955;</a
  ><a name="1972"
  > </a
  ><a name="1973" href="Session.Examples.BankAccount.html#1973" class="Bound"
  >_</a
  ><a name="1974"
  > </a
  ><a name="1975" class="Symbol"
  >&#8594;</a
  ><a name="1976"
  > </a
  ><a name="1977" href="Session.html#321" class="InductiveConstructor"
  >`I</a
  ><a name="1979"
  > </a
  ><a name="1980" href="Base.html#168" class="InductiveConstructor"
  >tt</a
  ><a name="1982" class="Symbol"
  >)</a
  ><a name="1983"
  > </a
  ><a name="1984" href="Data.Product.html#509" class="InductiveConstructor Operator"
  >&#171;&#171;</a
  ><a name="1986" class="Symbol"
  >)</a
  ><a name="1987"
  >
                    </a
  ><a name="2008" href="Session.html#12647" class="Function Operator"
  >[IO</a
  ><a name="2011"
  > </a
  ><a name="2012" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="2013"
  > </a
  ><a name="2014" href="Session.html#12647" class="Function Operator"
  >]&gt;</a
  ><a name="2016"
  >
                    </a
  ><a name="2037" href="Data.List.html#696" class="InductiveConstructor"
  >[]</a
  ><a name="2039"
  >
</a
  ><a name="2040" href="Session.Examples.BankAccount.html#1913" class="Function"
  >fund</a
  ><a name="2044"
  > </a
  ><a name="2045" href="Session.Examples.BankAccount.html#2045" class="Bound"
  >init</a
  ><a name="2049"
  > </a
  ><a name="2050" class="Symbol"
  >=</a
  ><a name="2051"
  > </a
  ><a name="2052" href="Session.html#11490" class="Function"
  >put</a
  ><a name="2055"
  > </a
  ><a name="2056" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="2058"
  > </a
  ><a name="2059" href="Session.Examples.BankAccount.html#2045" class="Bound"
  >init</a
  ><a name="2063"
  >
          </a
  ><a name="2074" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="2075"
  > </a
  ><a name="2076" href="Session.html#11699" class="Function"
  >get</a
  ><a name="2079"
  > </a
  ><a name="2080" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="2082"
  > </a
  ><a name="2083" class="Symbol"
  >(</a
  ><a name="2084" href="Data.Maybe.html#984" class="Function"
  >1+.maybe</a
  ><a name="2092"
  > </a
  ><a name="2093" class="Symbol"
  >(&#955;</a
  ><a name="2095"
  > </a
  ><a name="2096" href="Session.Examples.BankAccount.html#2096" class="Bound"
  >n</a
  ><a name="2097"
  > </a
  ><a name="2098" class="Symbol"
  >&#8594;</a
  ><a name="2099"
  > </a
  ><a name="2100" href="Session.html#9609" class="InductiveConstructor Operator"
  >end</a
  ><a name="2103"
  > </a
  ><a name="2104" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="2106"
  > </a
  ><a name="2107" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="2108"
  > </a
  ><a name="2109" href="Session.html#9533" class="InductiveConstructor Operator"
  >&#8657;</a
  ><a name="2110"
  > </a
  ><a name="2111" href="IO.Primitive.html#588" class="Postulate"
  >return</a
  ><a name="2117"
  > </a
  ><a name="2118" href="Session.Examples.BankAccount.html#2096" class="Bound"
  >n</a
  ><a name="2119"
  >   </a
  ><a name="2122" class="Symbol"
  >)</a
  ><a name="2123"
  >
                             </a
  ><a name="2153" class="Symbol"
  >(</a
  ><a name="2154"
  >      </a
  ><a name="2160" href="Session.html#9609" class="InductiveConstructor Operator"
  >end</a
  ><a name="2163"
  > </a
  ><a name="2164" href="Data.List.Any.html#1169" class="InductiveConstructor Operator"
  >Z|</a
  ><a name="2166"
  > </a
  ><a name="2167" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="2168"
  > </a
  ><a name="2169" href="Session.html#9533" class="InductiveConstructor Operator"
  >&#8657;</a
  ><a name="2170"
  > </a
  ><a name="2171" href="IO.Primitive.html#588" class="Postulate"
  >return</a
  ><a name="2177"
  > </a
  ><a name="2178" href="Session.Examples.BankAccount.html#2045" class="Bound"
  >init</a
  ><a name="2182" class="Symbol"
  >))</a
  ><a name="2184"
  ></pre>

<pre></a
  ><a name="2210" href="Session.Examples.BankAccount.html#2210" class="Function"
  >test</a
  ><a name="2214"
  > </a
  ><a name="2215" class="Symbol"
  >:</a
  ><a name="2216"
  > </a
  ><a name="2217" href="Session.html#12685" class="Function"
  >IOProc</a
  ><a name="2223"
  > </a
  ><a name="2224" href="Base.html#136" class="Record"
  >&#8868;</a
  ><a name="2225"
  >
</a
  ><a name="2226" href="Session.Examples.BankAccount.html#2210" class="Function"
  >test</a
  ><a name="2230"
  > </a
  ><a name="2231" class="Symbol"
  >=</a
  ><a name="2232"
  > </a
  ><a name="2233" href="Session.Examples.BankAccount.html#2233" class="Bound"
  >l</a
  ><a name="2234"
  > </a
  ><a name="2235" href="Session.html#11182" class="Function"
  >&lt;-</a
  ><a name="2237"
  > </a
  ><a name="2238" href="Session.html#9609" class="InductiveConstructor Operator"
  >new</a
  ><a name="2241"
  >
     </a
  ><a name="2247" href="Session.html#11182" class="Function"
  >&#8943;</a
  ><a name="2248"
  > </a
  ><a name="2249" href="Session.Examples.BankAccount.html#2249" class="Bound"
  >r</a
  ><a name="2250"
  > </a
  ><a name="2251" href="Session.html#11182" class="Function"
  >&lt;-</a
  ><a name="2253"
  > </a
  ><a name="2254" href="Session.html#9609" class="InductiveConstructor Operator"
  >new</a
  ><a name="2257"
  >
     </a
  ><a name="2263" href="Session.html#11182" class="Function"
  >&#8943;</a
  ><a name="2264"
  > </a
  ><a name="2265" href="Session.html#9609" class="InductiveConstructor Operator"
  >fork</a
  ><a name="2269"
  > </a
  ><a name="2270" class="Symbol"
  >(</a
  ><a name="2271" href="Data.List.All.html#779" class="InductiveConstructor"
  >[]</a
  ><a name="2273"
  > </a
  ><a name="2274" href="Data.List.All.html#796" class="InductiveConstructor Operator"
  >,&#775;</a
  ><a name="2276"
  > </a
  ><a name="2277" href="Session.html#1950" class="InductiveConstructor"
  >+-</a
  ><a name="2279"
  > </a
  ><a name="2280" href="Data.List.All.html#796" class="InductiveConstructor Operator"
  >,&#775;</a
  ><a name="2282"
  >  </a
  ><a name="2284" href="Session.html#1946" class="InductiveConstructor"
  >+</a
  ><a name="2285" class="Symbol"
  >)</a
  ><a name="2286"
  > </a
  ><a name="2287" class="Symbol"
  >(</a
  ><a name="2288"
  >  </a
  ><a name="2290" href="Session.Examples.BankAccount.html#2290" class="Bound"
  >res</a
  ><a name="2293"
  > </a
  ><a name="2294" href="Session.html#11182" class="Function"
  >&lt;-</a
  ><a name="2296"
  > </a
  ><a name="2297" href="Session.Examples.BankAccount.html#1913" class="Function"
  >fund</a
  ><a name="2301"
  > </a
  ><a name="2302" class="Number"
  >10</a
  ><a name="2304"
  >
                            </a
  ><a name="2333" href="Session.html#11182" class="Function"
  >&#8943;</a
  ><a name="2334"
  > </a
  ><a name="2335" href="Session.html#9533" class="InductiveConstructor Operator"
  >&#8657;</a
  ><a name="2336"
  > </a
  ><a name="2337" href="Session.Examples.BankAccount.html#2519" class="Function"
  >log</a
  ><a name="2340"
  > </a
  ><a name="2341" class="String"
  >&quot;Source = &quot;</a
  ><a name="2352"
  > </a
  ><a name="2353" href="Session.Examples.BankAccount.html#2290" class="Bound"
  >res</a
  ><a name="2356" class="Symbol"
  >)</a
  ><a name="2357"
  >
     </a
  ><a name="2363" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="2364"
  > </a
  ><a name="2365" href="Session.html#9609" class="InductiveConstructor Operator"
  >fork</a
  ><a name="2369"
  > </a
  ><a name="2370" class="Symbol"
  >(</a
  ><a name="2371" href="Data.List.All.html#779" class="InductiveConstructor"
  >[]</a
  ><a name="2373"
  > </a
  ><a name="2374" href="Data.List.All.html#796" class="InductiveConstructor Operator"
  >,&#775;</a
  ><a name="2376"
  > </a
  ><a name="2377" href="Base.html#4867" class="InductiveConstructor"
  >+</a
  ><a name="2378"
  >  </a
  ><a name="2380" href="Data.List.All.html#796" class="InductiveConstructor Operator"
  >,&#775;</a
  ><a name="2382"
  > </a
  ><a name="2383" href="Session.html#1950" class="InductiveConstructor"
  >+-</a
  ><a name="2385" class="Symbol"
  >)</a
  ><a name="2386"
  > </a
  ><a name="2387" class="Symbol"
  >(</a
  ><a name="2388"
  >  </a
  ><a name="2390" href="Session.Examples.BankAccount.html#2390" class="Bound"
  >res</a
  ><a name="2393"
  > </a
  ><a name="2394" href="Session.html#11182" class="Function"
  >&lt;-</a
  ><a name="2396"
  > </a
  ><a name="2397" href="Session.Examples.BankAccount.html#1913" class="Function"
  >fund</a
  ><a name="2401"
  > </a
  ><a name="2402" class="Number"
  >30</a
  ><a name="2404"
  >
                            </a
  ><a name="2433" href="Session.html#11182" class="Function"
  >&#8943;</a
  ><a name="2434"
  > </a
  ><a name="2435" href="Session.html#9533" class="InductiveConstructor Operator"
  >&#8657;</a
  ><a name="2436"
  > </a
  ><a name="2437" href="Session.Examples.BankAccount.html#2519" class="Function"
  >log</a
  ><a name="2440"
  > </a
  ><a name="2441" class="String"
  >&quot;Target = &quot;</a
  ><a name="2452"
  > </a
  ><a name="2453" href="Session.Examples.BankAccount.html#2390" class="Bound"
  >res</a
  ><a name="2456" class="Symbol"
  >)</a
  ><a name="2457"
  >
     </a
  ><a name="2463" href="Session.html#11371" class="Function Operator"
  >&#187;</a
  ><a name="2464"
  > </a
  ><a name="2465" href="Session.Examples.BankAccount.html#845" class="Function"
  >moveMoney</a
  ><a name="2474"
  > </a
  ><a name="2475" class="Number"
  >8</a
  ><a name="2476"
  >
  </a
  ><a name="2479" class="Keyword"
  >where</a
  ><a name="2484"
  > </a
  ><a name="2485" class="Keyword"
  >open</a
  ><a name="2489"
  > </a
  ><a name="2490" class="Keyword"
  >import</a
  ><a name="2496"
  > </a
  ><a name="2497" href="Data.Nat.Show.html#1" class="Module"
  >Data.Nat.Show</a
  ><a name="2510"
  >
        </a
  ><a name="2519" href="Session.Examples.BankAccount.html#2519" class="Function"
  >log</a
  ><a name="2522"
  > </a
  ><a name="2523" class="Symbol"
  >:</a
  ><a name="2524"
  > </a
  ><a name="2525" class="Symbol"
  >_</a
  ><a name="2526"
  > </a
  ><a name="2527" class="Symbol"
  >&#8594;</a
  ><a name="2528"
  > </a
  ><a name="2529" href="Data.Nat.html#698" class="Datatype"
  >&#8469;</a
  ><a name="2530"
  > </a
  ><a name="2531" class="Symbol"
  >&#8594;</a
  ><a name="2532"
  > </a
  ><a name="2533" href="IO.Primitive.html#448" class="Postulate"
  >IO</a
  ><a name="2535"
  > </a
  ><a name="2536" href="Base.html#136" class="Record"
  >&#8868;</a
  ><a name="2537"
  >
        </a
  ><a name="2546" href="Session.Examples.BankAccount.html#2519" class="Function"
  >log</a
  ><a name="2549"
  > </a
  ><a name="2550" href="Session.Examples.BankAccount.html#2550" class="Bound"
  >xs</a
  ><a name="2552"
  > </a
  ><a name="2553" href="Session.Examples.BankAccount.html#2553" class="Bound"
  >n</a
  ><a name="2554"
  > </a
  ><a name="2555" class="Symbol"
  >=</a
  ><a name="2556"
  > </a
  ><a name="2557" href="IO.Primitive.html#1466" class="Postulate"
  >putStr</a
  ><a name="2563"
  >   </a
  ><a name="2566" href="Base.html#4675" class="Function Operator"
  >&#171;</a
  ><a name="2567"
  > </a
  ><a name="2568" href="Session.Examples.BankAccount.html#2550" class="Bound"
  >xs</a
  ><a name="2570"
  >     </a
  ><a name="2575" href="Base.html#4675" class="Function Operator"
  >&#187;</a
  ><a name="2576"
  > </a
  ><a name="2577" href="IO.Primitive.html#628" class="Postulate Operator"
  >&gt;&gt;=</a
  ><a name="2580"
  > </a
  ><a name="2581" class="Symbol"
  >&#955;</a
  ><a name="2582"
  > </a
  ><a name="2583" href="Session.Examples.BankAccount.html#2583" class="Bound"
  >_</a
  ><a name="2584"
  > </a
  ><a name="2585" class="Symbol"
  >&#8594;</a
  ><a name="2586"
  >
                   </a
  ><a name="2606" href="IO.Primitive.html#1501" class="Postulate"
  >putStrLn</a
  ><a name="2614"
  > </a
  ><a name="2615" href="Base.html#4675" class="Function Operator"
  >&#171;</a
  ><a name="2616"
  > </a
  ><a name="2617" href="Data.Nat.Show.html#941" class="Function"
  >show</a
  ><a name="2621"
  > </a
  ><a name="2622" href="Session.Examples.BankAccount.html#2553" class="Bound"
  >n</a
  ><a name="2623"
  > </a
  ><a name="2624" href="Base.html#4675" class="Function Operator"
  >&#187;</a
  ><a name="2625"
  > </a
  ><a name="2626" href="IO.Primitive.html#628" class="Postulate Operator"
  >&gt;&gt;=</a
  ><a name="2629"
  > </a
  ><a name="2630" class="Symbol"
  >&#955;</a
  ><a name="2631"
  > </a
  ><a name="2632" href="Session.Examples.BankAccount.html#2632" class="Bound"
  >_</a
  ><a name="2633"
  > </a
  ><a name="2634" class="Symbol"
  >&#8594;</a
  ><a name="2635"
  >
                   </a
  ><a name="2655" href="IO.Primitive.html#588" class="Postulate"
  >return</a
  ><a name="2661"
  > </a
  ><a name="2662" class="Symbol"
  >_</a
  ><a name="2663"
  ></pre>

<pre></a
  ><a name="2689" href="Session.Examples.BankAccount.html#2689" class="Function"
  >main</a
  ><a name="2693"
  > </a
  ><a name="2694" class="Symbol"
  >:</a
  ><a name="2695"
  > </a
  ><a name="2696" href="IO.Primitive.html#448" class="Postulate"
  >IO</a
  ><a name="2698"
  > </a
  ><a name="2699" href="Unit.html#194" class="Function"
  >C.&lt;&gt;</a
  ><a name="2703"
  >
</a
  ><a name="2704" href="Session.Examples.BankAccount.html#2689" class="Function"
  >main</a
  ><a name="2708"
  > </a
  ><a name="2709" class="Symbol"
  >=</a
  ><a name="2710"
  > </a
  ><a name="2711" href="Session.html#13684" class="Function"
  >run</a
  ><a name="2714"
  > </a
  ><a name="2715" href="Session.Examples.BankAccount.html#2210" class="Function"
  >test</a
  ><a name="2719"
  > </a
  ><a name="2720" href="Data.List.All.html#779" class="InductiveConstructor"
  >[]</a
  ><a name="2722"
  > </a
  ><a name="2723" href="Session.html#13163" class="Function Operator"
  >&gt;&gt;</a
  ><a name="2725"
  > </a
  ><a name="2726" href="Control.Concurrent.html#342" class="Function"
  >C.threadDelay</a
  ><a name="2739"
  > </a
  ><a name="2740" href="Control.Concurrent.html#322" class="Function"
  >C.onesec</a
  ><a name="2748"
  ></pre></body></html>